cat("Predicted 50% year:", round(50 / slope + 1896))
before_cold_war <- subset(athletes, Year < 1947 & (NOC == "USA" | NOC == "RUS"))
before_cold_war_participation <- data.frame(summarize(group_by(count(group_by(before_cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation) + geom_line(aes(x = Year, y = Participants, color = NOC)) + labs(title = "USA and Russia's participation before Cold War")
before_cold_war_participation.plot
cold_war <- subset(athletes, Year >= 1947 & Year <= 1991 & (NOC == "USA" | NOC == "RUS"))
cold_war_participation <- data.frame(summarize(group_by(count(group_by(cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
cold_war_participation.plot <- ggplot(data = cold_war_participation) + geom_line(aes(x = Year, y = Participants, color = NOC)) + labs(title = "USA and Russia's participation during Cold War")
cold_war_participation.plot
russia_participation <- sum(subset(before_cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(before_cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia before the cold war", russia_participation, end = "\n")
cat("Number of participants by USA before the cold war", usa_participation)
russia_participation <- sum(subset(cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia", russia_participation, end = "\n")
cat("Number of participants by USA", usa_participation)
before_cold_war_performance <- summarize(group_by(subset(before_cold_war, !is.na(Medal)), Year, NOC), Winners = n())
before_cold_war_performance.plot <- ggplot(data = before_cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance before the Cold War")
before_cold_war_performance.plot
cold_war_performance <- summarize(group_by(subset(cold_war, !is.na(Medal)), Year, NOC), Winners = n())
cold_war_performance.plot <- ggplot(data = cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance during the Cold War")
cold_war_performance.plot
russia_winners <- sum(subset(before_cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(before_cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia before the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA before the cold war:", usa_winners, end = "\n")
russia_winners <- sum(subset(cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia during the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA during the cold war:", usa_winners)
country_medals.total <- country_medals %>% group_by(NOC) %>% summarize(Medal_Count = sum(Medal_Count))
country_medals.total <- data.frame(country_medals.total[order(country_medals.total$Medal_Count, decreasing = T),])
print(country_medals.total[1:5,])
country_medals.sport <- winners_only %>% group_by(NOC, Sport) %>% summarize(Medal_Count = n())
country_medals.sport <- country_medals.sport %>% group_by(Sport) %>% filter(Medal_Count == max(Medal_Count))
country_medals.sport <- country_medals.sport[order(country_medals.sport$Medal_Count, decreasing = T),]
print(country_medals.sport)
View(athletes)
sport_events <- athletes %>% group_by(Sport, Event) %>% count()
View(sport_events)
sport_events <- athletes %>% group_by(Sport, Event) %>% count() %>% group_by(Sport) %>% summarize(Event_count = n())
View(winners_only)
sport_events <- winners_only %>% group_by(Sport) %>% summarize(Event_count = n())
View(sport_events)
sport_medals <- winners_only %>% group_by(Sport) %>% summarize(Medal_count = n())
View(sport_medals)
sport_medals <- sport_medals[order(sport_medals$Medal_count, descending = T),]
sport_medals <- sport_medals[order(sport_medals$Medal_count, decreasing = T),]
print(sport_medals)
library(ggplot2)
library(dplyr)
#Load the dataset
athletes <- read.csv("athlete_events.csv", na.strings = c("NA"))
#Explore the structure of the dataset
str(athletes)
#athletes$Year <- as.integer(athletes$Year)
athletes$Medal <- factor(athletes$Medal, levels = c("Bronze", "Silver", "Gold"), ordered = TRUE)
athletes$NOC <- as.character(athletes$NOC)
#athletes$Gender <- as.factor(athletes$Gender)
athletes <- subset(athletes, select = -c(Age, Height, Weight, City, Games))
athletes <- subset(athletes, Season == "Summer")
hosts <- data.frame(Year = c(seq(1896, 1912, 4), seq(1920, 1936, 4), seq(1948, 2016, 4)), Host_NOC = c("GRE", "FRA", "USA", "GBR", "SWE", "BEL", "FRA", "NED", "USA", "GER", "GBR", "FIN", "AUS", "ITA", "JPN", "MEX", "GER", "CAN", "RUS", "USA", "KOR", "ESP", "USA", "AUS", "GRE", "CHN", "GBR", "BRA"))
athletes <- merge(athletes, hosts, by.x = "Year", by.y = "Year")
athletes$Host_NOC[athletes$Year == 1956 & athletes$City == "Stockholm"] <- "SWE"
athletes$Host_NOC <- as.character(athletes$Host_NOC)
athletes$NOC[athletes$NOC == "URS"] <- "RUS"
athletes$NOC[athletes$NOC == "FRG"] <- "GER"
athletes$NOC[athletes$NOC == "GDR"] <- "GER"
athletes$NOC[athletes$NOC == "ANZ"] <- "AUS"
#Equating China and Hong Kong would help too, but it seems like they have been participating as different teams since 1952.
summary(athletes)
#Subset data to obtain only the medal winners
winners_only <- subset(athletes, !is.na(Medal))
country_medals <- summarize(group_by(winners_only, Year, NOC), Medal_Count = n())
country_medals.plot <- ggplot(data = country_medals) + geom_point(aes(x = Year, y = Medal_Count, color = NOC), show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years")
country_medals.plot
#Find the total medal count per year
total_medals <- winners_only %>% group_by(Year) %>% summarize(Medal_Count = n())
#Include all of the host countries
hosts_only <- subset(winners_only, NOC %in% hosts$Host_NOC)
#Subset by medals won when the country that was a host country
medals_when_host <- subset(hosts_only, NOC == Host_NOC) %>% group_by(Year, NOC) %>% summarize(Medal_Count = n())
#Proportion of how many medals the host contry won out of all the medals avaliable for that year
host_medal_proportion <- data.frame(NOC = medals_when_host$NOC, Proportion = medals_when_host$Medal_Count / total_medals$Medal_Count)
#If a country hosted more than once, find the average of the proportion
host_medal_proportion <- host_medal_proportion %>% group_by(NOC) %>% summarize(Avg_Proportion = mean(Proportion))
#Subset by medals won when not acting as host country
medals_when_not_host <- subset(hosts_only, NOC != Host_NOC) %>% group_by(Year, NOC) %>% summarize(Medal_Count = n())
#Proportion of how many medals the host countries won out of medals avaliable when they are not host country
nonhost_medal_proportion <- merge(medals_when_not_host, total_medals, by.x = "Year", by.y = "Year")
nonhost_medal_proportion$Proportion <- nonhost_medal_proportion$Medal_Count.x / nonhost_medal_proportion$Medal_Count.y
#Average of proportion of medals won when a host country wasn't acting as a host country
nonhost_medal_proportion <- nonhost_medal_proportion %>% group_by(NOC) %>% summarize(Avg_Proportion = mean(Proportion))
host_advantage_test <- t.test(host_medal_proportion$Avg_Proportion, nonhost_medal_proportion$Avg_Proportion, paired = T, conf.level = 0.95, alternative = "greater")
host_advantage_test
unique_events_by_year <- data.frame(summarize(group_by(count(group_by(athletes, Year, Event)), Year), Events = n()))
unique_events_by_year.plot <- ggplot(data = unique_events_by_year) + geom_line(aes(x = Year, y = Events)) + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot
participation <- data.frame(summarize(group_by(count(group_by(athletes, Year, ID)), Year), Participants = n()))
participation.plot <- ggplot(data = participation) + geom_line(aes(x = Year, y = Participants)) + labs(y = "Unique Athletes", title = "Unique Athletes at each Olympic")
participation.plot
gender_participation <- data.frame(summarize(group_by(count(group_by(athletes, Year, Sex, ID)), Year, Sex), Participants = n()))
gender_participation <- add_row(gender_participation, Year = 1896, Sex = "F", Participants = 0, .before = 1)
gender_participation.plot <- ggplot(data = gender_participation) + geom_line(aes(x = Year, y = Participants, color = Sex)) + labs(title = "Number of Men and Women Participants over the years")
gender_participation.plot
#Difference in medal count for men and women
women_participation <- data.frame(Year = hosts$Year, Proportion = gender_participation$Participants[gender_participation$Sex == "F"] / participation$Participants * 100)
women_participation.plot <- ggplot(data = women_participation) + geom_line(aes(x = Year, y = Proportion)) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years")
women_participation.plot
#Create linear model for difference in medal count VS year
proportion_model <- lm(I(Proportion - 0) ~ I(Year - 1896) + 0, data = women_participation)
slope <- proportion_model$coefficients
cat("Slope:", slope)
cat("Intercept:", 0)
prop_func <- function(year) {
slope * (year - 1896)
}
women_participation.plot2 <- ggplot(data = women_participation, aes(x = Year)) + stat_function(fun = prop_func) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + geom_point(aes(x = Year, y = Proportion))
women_participation.plot2
cat("Predicted 50% year:", round(50 / slope + 1896))
before_cold_war <- subset(athletes, Year < 1947 & (NOC == "USA" | NOC == "RUS"))
before_cold_war_participation <- data.frame(summarize(group_by(count(group_by(before_cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation) + geom_line(aes(x = Year, y = Participants, color = NOC)) + labs(title = "USA and Russia's participation before Cold War")
before_cold_war_participation.plot
cold_war <- subset(athletes, Year >= 1947 & Year <= 1991 & (NOC == "USA" | NOC == "RUS"))
cold_war_participation <- data.frame(summarize(group_by(count(group_by(cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
cold_war_participation.plot <- ggplot(data = cold_war_participation) + geom_line(aes(x = Year, y = Participants, color = NOC)) + labs(title = "USA and Russia's participation during Cold War")
cold_war_participation.plot
russia_participation <- sum(subset(before_cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(before_cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia before the cold war", russia_participation, end = "\n")
cat("Number of participants by USA before the cold war", usa_participation)
russia_participation <- sum(subset(cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia", russia_participation, end = "\n")
cat("Number of participants by USA", usa_participation)
before_cold_war_performance <- summarize(group_by(subset(before_cold_war, !is.na(Medal)), Year, NOC), Winners = n())
before_cold_war_performance.plot <- ggplot(data = before_cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance before the Cold War")
before_cold_war_performance.plot
cold_war_performance <- summarize(group_by(subset(cold_war, !is.na(Medal)), Year, NOC), Winners = n())
cold_war_performance.plot <- ggplot(data = cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance during the Cold War")
cold_war_performance.plot
russia_winners <- sum(subset(before_cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(before_cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia before the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA before the cold war:", usa_winners, end = "\n")
russia_winners <- sum(subset(cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia during the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA during the cold war:", usa_winners)
country_medals.total <- country_medals %>% group_by(NOC) %>% summarize(Medal_Count = sum(Medal_Count))
country_medals.total <- data.frame(country_medals.total[order(country_medals.total$Medal_Count, decreasing = T),])
print(country_medals.total[1:5,])
country_medals.sport <- winners_only %>% group_by(NOC, Sport) %>% summarize(Medal_Count = n())
country_medals.sport <- country_medals.sport %>% group_by(Sport) %>% filter(Medal_Count == max(Medal_Count))
country_medals.sport <- country_medals.sport[order(country_medals.sport$Medal_Count, decreasing = T),]
print(country_medals.sport)
sport_medals <- winners_only %>% group_by(Sport) %>% summarize(Medal_count = n())
sport_medals <- sport_medals[order(sport_medals$Medal_count, decreasing = T),]
print(sport_medals)
#Create linear model for difference in medal count VS year
proportion_model <- lm(I(Proportion - 0) ~ I(Year - 1896) + 0, data = women_participation)
slope <- proportion_model$coefficients
cat("Slope:", slope, end = "\n")
cat("Intercept:", 0)
library(dplyr)
library(ggplot2)
library(dplyr)
#Load the dataset
athletes <- read.csv("athlete_events.csv", na.strings = c("NA"))
#Explore the structure of the dataset
str(athletes)
#athletes$Year <- as.integer(athletes$Year)
athletes$Medal <- factor(athletes$Medal, levels = c("Bronze", "Silver", "Gold"), ordered = TRUE)
athletes$NOC <- as.character(athletes$NOC)
#athletes$Gender <- as.factor(athletes$Gender)
athletes <- subset(athletes, select = -c(Age, Height, Weight, City, Games))
athletes <- subset(athletes, Season == "Summer")
hosts <- data.frame(Year = c(seq(1896, 1912, 4), seq(1920, 1936, 4), seq(1948, 2016, 4)), Host_NOC = c("GRE", "FRA", "USA", "GBR", "SWE", "BEL", "FRA", "NED", "USA", "GER", "GBR", "FIN", "AUS", "ITA", "JPN", "MEX", "GER", "CAN", "RUS", "USA", "KOR", "ESP", "USA", "AUS", "GRE", "CHN", "GBR", "BRA"))
athletes <- merge(athletes, hosts, by.x = "Year", by.y = "Year")
athletes$Host_NOC[athletes$Year == 1956 & athletes$City == "Stockholm"] <- "SWE"
athletes$Host_NOC <- as.character(athletes$Host_NOC)
athletes$NOC[athletes$NOC == "URS"] <- "RUS"
athletes$NOC[athletes$NOC == "FRG"] <- "GER"
athletes$NOC[athletes$NOC == "GDR"] <- "GER"
athletes$NOC[athletes$NOC == "ANZ"] <- "AUS"
#Equating China and Hong Kong would help too, but it seems like they have been participating as different teams since 1952.
summary(athletes)
#Subset data to obtain only the medal winners
winners_only <- subset(athletes, !is.na(Medal))
country_medals <- summarize(group_by(winners_only, Year, NOC), Medal_Count = n())
country_medals.plot <- ggplot(data = country_medals) + geom_point(aes(x = Year, y = Medal_Count, color = NOC), show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years")
country_medals.plot
#Find the total medal count per year
total_medals <- winners_only %>% group_by(Year) %>% summarize(Medal_Count = n())
#Include all of the host countries
hosts_only <- subset(winners_only, NOC %in% hosts$Host_NOC)
#Subset by medals won when the country that was a host country
medals_when_host <- subset(hosts_only, NOC == Host_NOC) %>% group_by(Year, NOC) %>% summarize(Medal_Count = n())
#Proportion of how many medals the host contry won out of all the medals avaliable for that year
host_medal_proportion <- data.frame(NOC = medals_when_host$NOC, Proportion = medals_when_host$Medal_Count / total_medals$Medal_Count)
#If a country hosted more than once, find the average of the proportion
host_medal_proportion <- host_medal_proportion %>% group_by(NOC) %>% summarize(Avg_Proportion = mean(Proportion))
#Subset by medals won when not acting as host country
medals_when_not_host <- subset(hosts_only, NOC != Host_NOC) %>% group_by(Year, NOC) %>% summarize(Medal_Count = n())
#Proportion of how many medals the host countries won out of medals avaliable when they are not host country
nonhost_medal_proportion <- merge(medals_when_not_host, total_medals, by.x = "Year", by.y = "Year")
nonhost_medal_proportion$Proportion <- nonhost_medal_proportion$Medal_Count.x / nonhost_medal_proportion$Medal_Count.y
#Average of proportion of medals won when a host country wasn't acting as a host country
nonhost_medal_proportion <- nonhost_medal_proportion %>% group_by(NOC) %>% summarize(Avg_Proportion = mean(Proportion))
host_advantage_test <- t.test(host_medal_proportion$Avg_Proportion, nonhost_medal_proportion$Avg_Proportion, paired = T, conf.level = 0.95, alternative = "greater")
host_advantage_test
unique_events_by_year <- data.frame(summarize(group_by(count(group_by(athletes, Year, Event)), Year), Events = n()))
unique_events_by_year.plot <- ggplot(data = unique_events_by_year) + geom_line(aes(x = Year, y = Events)) + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year) + geom_line(aes(x = Year, y = Events)) + ylab("Number of Events") + labs(title = element_text("Number of Events at each Olympic", color = "blue"))
unique_events_by_year.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year) + geom_line(aes(x = Year, y = Events)) + ylab("Number of Events") + labs(title = element_text("Number of Events at each Olympic", color = "blue", size = 14))
unique_events_by_year.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year) + geom_line(aes(x = Year, y = Events, color = "red")) + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot <- ggplot(data = unique_events_by_year) + geom_line(aes(x = Year, y = Events, color = "red")) + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year) + geom_line(aes(x = Year, y = Events, color = "red", show.legend = F)) + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, show.legend = F) + geom_line(aes(x = Year, y = Events, color = "red")) + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, show.legend = F) + geom_line(aes(x = Year, y = Events, color = "red")) + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, aes(x = Year, y = Events)) + geom_line(color = "red") + ylab("Number of Events") + labs(title = "Number of Events at each Olympic")
unique_events_by_year.plot
c((1890, 1896), (1, 2, 3))
a=c(1, 2, 3)
b=c(10, 11, 12)
c(a, b)
View(athletes)
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, aes(x = Year, y = Events)) + geom_line(color = "red") + ylab("Number of Events") + labs(title = "Number of Events at each Olympic") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), c(2016, 2025)))
unique_events_by_year.plot
participation <- data.frame(summarize(group_by(count(group_by(athletes, Year, ID)), Year), Participants = n()))
participation.plot <- ggplot(data = participation) + geom_line(aes(x = Year, y = Participants)) + labs(y = "Unique Athletes", title = "Unique Athletes at each Olympic")
participation.plot
participation.plot <- ggplot(data = participation, aes(x = Year, y = Participants)) + geom_line(color = "red") + labs(y = "Unique Athletes", title = "Unique Athletes at each Olympic") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), c(2016, 2025)))
participation.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, aes(x = Year, y = Events)) + geom_line(color = "red") + ylab("Number of Events") + labs(title = "Number of Events at each Olympic") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), c(2016, 2025))) + scale_y_continuous(breaks = seq(0, 325, 25))
unique_events_by_year.plot
participation.plot <- ggplot(data = participation, aes(x = Year, y = Participants)) + geom_line(color = "red") + labs(y = "Unique Athletes", title = "Unique Athletes at each Olympic") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), c(2016, 2025))) + scale_y_continuous(breaks = seq(0, 12000, 1500))
participation.plot
gender_participation <- data.frame(summarize(group_by(count(group_by(athletes, Year, Sex, ID)), Year, Sex), Participants = n()))
gender_participation <- add_row(gender_participation, Year = 1896, Sex = "F", Participants = 0, .before = 1)
gender_participation.plot <- ggplot(data = gender_participation) + geom_line(aes(x = Year, y = Participants, color = Sex)) + labs(title = "Number of Men and Women Participants over the years")
gender_participation.plot
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years")
gender_participation.plot
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), c(2016, 2025)))
gender_participation.plot
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), 2016))
gender_participation.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, aes(x = Year, y = Events)) + geom_line(color = "red") + ylab("Number of Events") + labs(title = "Number of Events at each Olympic") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), 2016)) + scale_y_continuous(breaks = seq(0, 325, 25))
unique_events_by_year.plot
participation.plot <- ggplot(data = participation, aes(x = Year, y = Participants)) + geom_line(color = "red") + labs(y = "Unique Athletes", title = "Unique Athletes at each Olympic") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), 2016)) + scale_y_continuous(breaks = seq(0, 12000, 1500))
participation.plot
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2010, 15), 2016)) + scale_y_continuous(breaks = seq(0, 7000, 1000))
gender_participation.plot
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = c(c(1890, 1896), seq(1905, 2012, 16), 2016)) + scale_y_continuous(breaks = seq(0, 7000, 1000))
gender_participation.plot
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = c(1890, seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 7000, 1000))
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = c(1890, seq(1896, 2016, 12))) + scale_y_continuous(breaks = seq(0, 7000, 1000))
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 7000, 1000))
gender_participation.plot
participation.plot <- ggplot(data = participation, aes(x = Year, y = Participants)) + geom_line(color = "red") + labs(y = "Unique Athletes", title = "Unique Athletes at each Olympic") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 12000, 1500))
participation.plot
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, aes(x = Year, y = Events)) + geom_line(color = "red") + ylab("Number of Events") + labs(title = "Number of Events at each Olympic") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 325, 25))
unique_events_by_year.plot
#Difference in medal count for men and women
women_participation <- data.frame(Year = hosts$Year, Proportion = gender_participation$Participants[gender_participation$Sex == "F"] / participation$Participants * 100)
women_participation.plot <- ggplot(data = women_participation) + geom_line(aes(x = Year, y = Proportion)) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years")
women_participation.plot
women_participation.plot <- ggplot(data = women_participation) + geom_line(aes(x = Year, y = Proportion)) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12))
women_participation.plot
women_participation.plot <- ggplot(data = women_participation, aes(x = Year, y = Proportion, color = "red")) + geom_line() + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12))
women_participation.plot
women_participation.plot <- ggplot(data = women_participation, aes(x = Year, y = Proportion, color = "red")) + geom_line() + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
women_participation.plot
women_participation.plot <- ggplot(data = women_participation, aes(x = Year, y = Proportion)) + geom_line(aes(color = "red")) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
women_participation.plot
women_participation.plot <- ggplot(data = women_participation, aes(x = Year, y = Proportion)) + geom_line(color = "red") + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
women_participation.plot
#Create linear model for difference in medal count VS year
proportion_model <- lm(I(Proportion - 0) ~ I(Year - 1896) + 0, data = women_participation)
slope <- proportion_model$coefficients
cat("Slope:", slope, end = "\n")
cat("Intercept:", 0)
prop_func <- function(year) {
slope * (year - 1896)
}
women_participation.plot2 <- ggplot(data = women_participation, aes(x = Year)) + stat_function(fun = prop_func) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + geom_point(aes(x = Year, y = Proportion))
women_participation.plot2
cat("Predicted 50% year:", round(50 / slope + 1896))
women_participation.plot2 <- ggplot(data = women_participation, aes(x = Year, y = Proportion)) + stat_function(fun = prop_func) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + geom_point() + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
women_participation.plot2
women_participation.plot2 <- ggplot(data = women_participation, aes(x = Year, y = Proportion)) + stat_function(fun = prop_func) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + geom_point(color = "red") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
women_participation.plot2
before_cold_war <- subset(athletes, Year < 1947 & (NOC == "USA" | NOC == "RUS"))
before_cold_war_participation <- data.frame(summarize(group_by(count(group_by(before_cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation) + geom_line(aes(x = Year, y = Participants, color = NOC)) + labs(title = "USA and Russia's participation before Cold War")
before_cold_war_participation.plot
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation before Cold War") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 550, 50))
before_cold_war_participation.plot
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation before Cold War") + scale_x_continuous(breaks = seq(1896, 1946, 10)) + scale_y_continuous(breaks = seq(0, 550, 50))
before_cold_war_participation.plot
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation before Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 10)) + scale_y_continuous(breaks = seq(0, 550, 50))
before_cold_war_participation.plot
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation before Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 5)) + scale_y_continuous(breaks = seq(0, 550, 50))
before_cold_war_participation.plot
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation before Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 8)) + scale_y_continuous(breaks = seq(0, 550, 50))
before_cold_war_participation.plot
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation before Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 4)) + scale_y_continuous(breaks = seq(0, 550, 50))
before_cold_war_participation.plot
cold_war <- subset(athletes, Year >= 1947 & Year <= 1991 & (NOC == "USA" | NOC == "RUS"))
cold_war_participation <- data.frame(summarize(group_by(count(group_by(cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
cold_war_participation.plot <- ggplot(data = cold_war_participation) + geom_line(aes(x = Year, y = Participants, color = NOC)) + labs(title = "USA and Russia's participation during Cold War")
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1936, 1986, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1986, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(0, 48, 8))
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4))
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(250, 600, 50))
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(250, 600, 25))
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(275, 600, 25))
cold_war_participation.plot
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(275, 550, 25))
cold_war_participation.plot
russia_participation <- sum(subset(before_cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(before_cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia before the cold war", russia_participation, end = "\n")
cat("Number of participants by USA before the cold war", usa_participation)
russia_participation <- sum(subset(cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia", russia_participation, end = "\n")
cat("Number of participants by USA", usa_participation)
before_cold_war_performance <- summarize(group_by(subset(before_cold_war, !is.na(Medal)), Year, NOC), Winners = n())
before_cold_war_performance.plot <- ggplot(data = before_cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance before the Cold War")
before_cold_war_performance.plot
before_cold_war_performance.plot <- ggplot(data = before_cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance before the Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 4)) + scale_y_continuous(breaks = seq(0, 400, 25))
before_cold_war_performance.plot
before_cold_war_performance.plot <- ggplot(data = before_cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance before the Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 4)) + scale_y_continuous(breaks = seq(0, 400, 50))
before_cold_war_performance.plot
cold_war_performance <- summarize(group_by(subset(cold_war, !is.na(Medal)), Year, NOC), Winners = n())
cold_war_performance.plot <- ggplot(data = cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance during the Cold War")
cold_war_performance.plot
cold_war_performance.plot <- ggplot(data = cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance during the Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(100, 450, 25))
cold_war_performance.plot
cold_war_performance.plot <- ggplot(data = cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance during the Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(100, 450, 50))
cold_war_performance.plot
russia_winners <- sum(subset(before_cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(before_cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia before the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA before the cold war:", usa_winners, end = "\n")
russia_winners <- sum(subset(cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia during the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA during the cold war:", usa_winners)
country_medals.total <- country_medals %>% group_by(NOC) %>% summarize(Medal_Count = sum(Medal_Count))
country_medals.total <- data.frame(country_medals.total[order(country_medals.total$Medal_Count, decreasing = T),])
print(country_medals.total[1:5,])
country_medals.sport <- winners_only %>% group_by(NOC, Sport) %>% summarize(Medal_Count = n())
country_medals.sport <- country_medals.sport %>% group_by(Sport) %>% filter(Medal_Count == max(Medal_Count))
country_medals.sport <- country_medals.sport[order(country_medals.sport$Medal_Count, decreasing = T),]
print(country_medals.sport)
sport_medals <- winners_only %>% group_by(Sport) %>% summarize(Medal_count = n())
sport_medals <- sport_medals[order(sport_medals$Medal_count, decreasing = T),]
print(sport_medals)
country_medals.plot <- ggplot(data = country_medals) + geom_point(aes(x = Year, y = Medal_Count, color = NOC), show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
country_medals.plot <- ggplot(data = country_medals) + geom_point(aes(x = Year, y = Medal_Count, color = NOC), show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 4)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
country_medals.plot <- ggplot(data = country_medals) + geom_point(aes(x = Year, y = Medal_Count, color = NOC), show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 8)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
country_medals.plot <- ggplot(data = country_medals) + geom_point(aes(x = Year, y = Medal_Count, color = NOC), show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
country_medals.plot <- ggplot(data = country_medals, aes(x = Year, y = Medal_Count, color = NOC)) + geom_point(show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
country_medals.plot <- ggplot(data = country_medals, aes(x = Year, y = Medal_Count, color = NOC)) + geom_point(show.legend = T) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
country_medals.plot <- ggplot(data = country_medals, aes(x = Year, y = Medal_Count, color = NOC)) + geom_point(show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
library(ggplot2)
library(dplyr)
#Load the dataset
athletes <- read.csv("athlete_events.csv", na.strings = c("NA"))
#Explore the structure of the dataset
str(athletes)
#athletes$Year <- as.integer(athletes$Year)
athletes$Medal <- factor(athletes$Medal, levels = c("Bronze", "Silver", "Gold"), ordered = TRUE)
athletes$NOC <- as.character(athletes$NOC)
#athletes$Gender <- as.factor(athletes$Gender)
athletes <- subset(athletes, select = -c(Age, Height, Weight, City, Games))
athletes <- subset(athletes, Season == "Summer")
hosts <- data.frame(Year = c(seq(1896, 1912, 4), seq(1920, 1936, 4), seq(1948, 2016, 4)), Host_NOC = c("GRE", "FRA", "USA", "GBR", "SWE", "BEL", "FRA", "NED", "USA", "GER", "GBR", "FIN", "AUS", "ITA", "JPN", "MEX", "GER", "CAN", "RUS", "USA", "KOR", "ESP", "USA", "AUS", "GRE", "CHN", "GBR", "BRA"))
athletes <- merge(athletes, hosts, by.x = "Year", by.y = "Year")
athletes$Host_NOC[athletes$Year == 1956 & athletes$City == "Stockholm"] <- "SWE"
athletes$Host_NOC <- as.character(athletes$Host_NOC)
athletes$NOC[athletes$NOC == "URS"] <- "RUS"
athletes$NOC[athletes$NOC == "FRG"] <- "GER"
athletes$NOC[athletes$NOC == "GDR"] <- "GER"
athletes$NOC[athletes$NOC == "ANZ"] <- "AUS"
#Equating China and Hong Kong would help too, but it seems like they have been participating as different teams since 1952.
summary(athletes)
#Subset data to obtain only the medal winners
winners_only <- subset(athletes, !is.na(Medal))
country_medals <- summarize(group_by(winners_only, Year, NOC), Medal_Count = n())
country_medals.plot <- ggplot(data = country_medals, aes(x = Year, y = Medal_Count, color = NOC)) + geom_point(show.legend = F) + labs(y = "Number of Medals", title = "Medals Earned by Countries over Years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 450, 50))
country_medals.plot
#Find the total medal count per year
total_medals <- winners_only %>% group_by(Year) %>% summarize(Medal_Count = n())
#Include all of the host countries
hosts_only <- subset(winners_only, NOC %in% hosts$Host_NOC)
#Subset by medals won when the country that was a host country
medals_when_host <- subset(hosts_only, NOC == Host_NOC) %>% group_by(Year, NOC) %>% summarize(Medal_Count = n())
#Proportion of how many medals the host contry won out of all the medals avaliable for that year
host_medal_proportion <- data.frame(NOC = medals_when_host$NOC, Proportion = medals_when_host$Medal_Count / total_medals$Medal_Count)
#If a country hosted more than once, find the average of the proportion
host_medal_proportion <- host_medal_proportion %>% group_by(NOC) %>% summarize(Avg_Proportion = mean(Proportion))
#Subset by medals won when not acting as host country
medals_when_not_host <- subset(hosts_only, NOC != Host_NOC) %>% group_by(Year, NOC) %>% summarize(Medal_Count = n())
#Proportion of how many medals the host countries won out of medals avaliable when they are not host country
nonhost_medal_proportion <- merge(medals_when_not_host, total_medals, by.x = "Year", by.y = "Year")
nonhost_medal_proportion$Proportion <- nonhost_medal_proportion$Medal_Count.x / nonhost_medal_proportion$Medal_Count.y
#Average of proportion of medals won when a host country wasn't acting as a host country
nonhost_medal_proportion <- nonhost_medal_proportion %>% group_by(NOC) %>% summarize(Avg_Proportion = mean(Proportion))
host_advantage_test <- t.test(host_medal_proportion$Avg_Proportion, nonhost_medal_proportion$Avg_Proportion, paired = T, conf.level = 0.95, alternative = "greater")
host_advantage_test
unique_events_by_year <- data.frame(summarize(group_by(count(group_by(athletes, Year, Event)), Year), Events = n()))
unique_events_by_year.plot <- ggplot(data = unique_events_by_year, aes(x = Year, y = Events)) + geom_line(color = "red") + ylab("Number of Events") + labs(title = "Number of Events at each Olympic") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 325, 25))
unique_events_by_year.plot
participation <- data.frame(summarize(group_by(count(group_by(athletes, Year, ID)), Year), Participants = n()))
participation.plot <- ggplot(data = participation, aes(x = Year, y = Participants)) + geom_line(color = "red") + labs(y = "Unique Athletes", title = "Unique Athletes at each Olympic") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 12000, 1500))
participation.plot
gender_participation <- data.frame(summarize(group_by(count(group_by(athletes, Year, Sex, ID)), Year, Sex), Participants = n()))
gender_participation <- add_row(gender_participation, Year = 1896, Sex = "F", Participants = 0, .before = 1)
gender_participation.plot <- ggplot(data = gender_participation, aes(x = Year, y = Participants, color = Sex)) + geom_line() + labs(title = "Number of Men and Women Participants over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 7000, 1000))
gender_participation.plot
#Difference in medal count for men and women
women_participation <- data.frame(Year = hosts$Year, Proportion = gender_participation$Participants[gender_participation$Sex == "F"] / participation$Participants * 100)
women_participation.plot <- ggplot(data = women_participation, aes(x = Year, y = Proportion)) + geom_line(color = "red") + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
women_participation.plot
#Create linear model for difference in medal count VS year
proportion_model <- lm(I(Proportion - 0) ~ I(Year - 1896) + 0, data = women_participation)
slope <- proportion_model$coefficients
cat("Slope:", slope, end = "\n")
cat("Intercept:", 0)
prop_func <- function(year) {
slope * (year - 1896)
}
women_participation.plot2 <- ggplot(data = women_participation, aes(x = Year, y = Proportion)) + stat_function(fun = prop_func) + labs(y = "Percent of Total Participation", title = "Women's Participation in Olympics over the years") + geom_point(color = "red") + scale_x_continuous(breaks = seq(1896, 2016, 12)) + scale_y_continuous(breaks = seq(0, 48, 8))
women_participation.plot2
cat("Predicted 50% year:", round(50 / slope + 1896))
before_cold_war <- subset(athletes, Year < 1947 & (NOC == "USA" | NOC == "RUS"))
before_cold_war_participation <- data.frame(summarize(group_by(count(group_by(before_cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
before_cold_war_participation.plot <- ggplot(data = before_cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation before Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 4)) + scale_y_continuous(breaks = seq(0, 550, 50))
before_cold_war_participation.plot
cold_war <- subset(athletes, Year >= 1947 & Year <= 1991 & (NOC == "USA" | NOC == "RUS"))
cold_war_participation <- data.frame(summarize(group_by(count(group_by(cold_war, Year, NOC, ID)), Year, NOC), Participants = n()))
cold_war_participation.plot <- ggplot(data = cold_war_participation, aes(x = Year, y = Participants, color = NOC)) + geom_line() + labs(title = "USA and Russia's participation during Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(275, 550, 25))
cold_war_participation.plot
russia_participation <- sum(subset(before_cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(before_cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia before the cold war", russia_participation, end = "\n")
cat("Number of participants by USA before the cold war", usa_participation)
russia_participation <- sum(subset(cold_war_participation, NOC == "RUS")$Participants)
usa_participation <- sum(subset(cold_war_participation, NOC == "USA")$Participants)
cat("Number of participants by Russia", russia_participation, end = "\n")
cat("Number of participants by USA", usa_participation)
before_cold_war_performance <- summarize(group_by(subset(before_cold_war, !is.na(Medal)), Year, NOC), Winners = n())
before_cold_war_performance.plot <- ggplot(data = before_cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance before the Cold War") + scale_x_continuous(breaks = seq(1896, 1936, 4)) + scale_y_continuous(breaks = seq(0, 400, 50))
before_cold_war_performance.plot
cold_war_performance <- summarize(group_by(subset(cold_war, !is.na(Medal)), Year, NOC), Winners = n())
cold_war_performance.plot <- ggplot(data = cold_war_performance) + geom_line(aes(x = Year, y = Winners, color = NOC)) + labs(y = "Number of Medals", title = "USA and Russia's Performance during the Cold War") + scale_x_continuous(breaks = seq(1948, 1988, 4)) + scale_y_continuous(breaks = seq(100, 450, 50))
cold_war_performance.plot
russia_winners <- sum(subset(before_cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(before_cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia before the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA before the cold war:", usa_winners, end = "\n")
russia_winners <- sum(subset(cold_war_performance, NOC == "RUS")$Winners)
usa_winners <- sum(subset(cold_war_performance, NOC == "USA")$Winners)
cat("Number of medals for Russia during the cold war:", russia_winners, end = "\n")
cat("Number of medals for USA during the cold war:", usa_winners)
country_medals.total <- country_medals %>% group_by(NOC) %>% summarize(Medal_Count = sum(Medal_Count))
country_medals.total <- data.frame(country_medals.total[order(country_medals.total$Medal_Count, decreasing = T),])
print(country_medals.total[1:5,])
country_medals.sport <- winners_only %>% group_by(NOC, Sport) %>% summarize(Medal_Count = n())
country_medals.sport <- country_medals.sport %>% group_by(Sport) %>% filter(Medal_Count == max(Medal_Count))
country_medals.sport <- country_medals.sport[order(country_medals.sport$Medal_Count, decreasing = T),]
print(country_medals.sport)
sport_medals <- winners_only %>% group_by(Sport) %>% summarize(Medal_count = n())
sport_medals <- sport_medals[order(sport_medals$Medal_count, decreasing = T),]
print(sport_medals)
ggsave("country_medals.png", plot=country_medals.plot)
ggsave("unique_events.png", plot=unique_events_by_year.plot)
ggsave("unique_athletes.png", plot=participation.plot)
ggsave("gender_participation.png", plot=gender_participation.plot)
ggsave("women_participation.png", plot=women_participation.plot)
ggsave("women_regression.png", plot=women_participation.plot2)
ggsave("before_cold_participation.png", plot=before_cold_war_participation.plot)
ggsave("during_cold_participation.png", plot=cold_war_participation.plot)
ggsave("before_cold_performance.png", plot=before_cold_war_performance.plot)
ggsave("during_cold_performance.png", plot=cold_war_performance.plot)
